<!DOCTYPE html>
<!--
 | Generated by Apache Maven Doxia at 2015-08-14 
 | Rendered using Apache Maven Fluido Skin 1.4
-->
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta name="Date-Revision-yyyymmdd" content="20150814" />
    <meta http-equiv="Content-Language" content="en" />
    <title>Apache Taverna &#x2013; API Consumer Tool</title>
    <link rel="stylesheet" href="../../css/apache-maven-fluido-1.4.min.css" />
    <link rel="stylesheet" href="../../css/site.css" />
    <link rel="stylesheet" href="../../css/print.css" media="print" />

      
    <script type="text/javascript" src="../../js/apache-maven-fluido-1.4.min.js"></script>

    
    <meta name="Notice" content="Licensed to the Apache Software Foundation (ASF) under one            or more contributor license agreements.  See the NOTICE file            distributed with this work for additional information            regarding copyright ownership.  The ASF licenses this file            to you under the Apache License, Version 2.0 (the            &quot;License&quot;); you may not use this file except in compliance            with the License.  You may obtain a copy of the License at            .              http://www.apache.org/licenses/LICENSE-2.0            .            Unless required by applicable law or agreed to in writing,            software distributed under the License is distributed on an            &quot;AS IS&quot; BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY            KIND, either express or implied.  See the License for the            specific language governing permissions and limitations            under the License." />              </head>
        <body class="topBarEnabled">
          
                        
                    
                

    <div id="topbar" class="navbar navbar-fixed-top ">
      <div class="navbar-inner">
                                  <div class="container" style="width: 90%;"><div class="nav-collapse">
            
                
                                                                                <a class="brand" href="../../"  title="Apache Taverna">

                                
                                                                                                                    <img src="../../img/taverna-logo-145x134.png" alt="Apache Taverna" />
                
                </a>
                    
                                <ul class="nav">
                          <li class="dropdown">
        <a href="#" class="dropdown-toggle" data-toggle="dropdown">Project <b class="caret"></b></a>
        <ul class="dropdown-menu">
        
                      <li>      <a href="../../index.html"  title="Home">Home</a>
</li>
                  
                      <li>      <a href="../../community/"  title="Community">Community</a>
</li>
                  
                      <li>      <a href="../../documentation/"  title="Documentation">Documentation</a>
</li>
                  
                      <li>      <a href="../../download/"  title="Download">Download</a>
</li>
                  
                      <li>      <a href="../../about/"  title="About us">About us</a>
</li>
                          </ul>
      </li>
                <li class="dropdown">
        <a href="#" class="dropdown-toggle" data-toggle="dropdown">Introduction <b class="caret"></b></a>
        <ul class="dropdown-menu">
        
                      <li>      <a href="../../introduction/"  title="Introduction to Taverna">Introduction to Taverna</a>
</li>
                  
                      <li>      <a href="../../introduction/features"  title="Features">Features</a>
</li>
                  
                      <li>      <a href="../../introduction/why-use-workflows"  title="Why use workflows?">Why use workflows?</a>
</li>
                  
                      <li>      <a href="../../#"  title="... (TODO)">... (TODO)</a>
</li>
                          </ul>
      </li>
                <li class="dropdown">
        <a href="#" class="dropdown-toggle" data-toggle="dropdown">Documentation <b class="caret"></b></a>
        <ul class="dropdown-menu">
        
                      <li>      <a href="../../documentation/"  title="Taverna docs">Taverna docs</a>
</li>
                  
                      <li>      <a href="../../documentation/glossary/"  title="Glossary">Glossary</a>
</li>
                  
                      <li>      <a href="../../documentation/scufl2/"  title="SCUFL2">SCUFL2</a>
</li>
                  
                      <li>      <a href="../../#"  title="... (TODO)">... (TODO)</a>
</li>
                          </ul>
      </li>
                <li class="dropdown">
        <a href="#" class="dropdown-toggle" data-toggle="dropdown">Download <b class="caret"></b></a>
        <ul class="dropdown-menu">
        
                      <li>      <a href="../../download/"  title="Which Taverna to download?">Which Taverna to download?</a>
</li>
                  
                      <li>      <a href="../../download/language/"  title="Language">Language</a>
</li>
                  
                      <li>      <a href="../../download/workbench/"  title="Workbench">Workbench</a>
</li>
                  
                      <li>      <a href="../../download/command-line-tool/"  title="Command Line Tool">Command Line Tool</a>
</li>
                  
                      <li>      <a href="../../#"  title="... (TODO)">... (TODO)</a>
</li>
                          </ul>
      </li>
                <li class="dropdown">
        <a href="#" class="dropdown-toggle" data-toggle="dropdown">Community <b class="caret"></b></a>
        <ul class="dropdown-menu">
        
                      <li>      <a href="../../community/"  title="Taverna Community">Taverna Community</a>
</li>
                  
                      <li>      <a href="../../community/lists"  title="Mailing lists">Mailing lists</a>
</li>
                  
                      <li>      <a href="../../community/contribute"  title="Contribute">Contribute</a>
</li>
                  
                      <li>      <a href="../../#"  title="... (TODO)">... (TODO)</a>
</li>
                          </ul>
      </li>
                  </ul>
          
                      <form id="search-form" action="https://www.google.com/search" method="get"  class="navbar-search pull-right" >
    
  <input value="$sitesearchValue" name="sitesearch" type="hidden"/>
  <input class="search-query" name="q" id="query" type="text" />
</form>
<script type="text/javascript" src="https://www.google.com/coop/cse/brand?form=search-form"></script>
          
                                                                            
                               <ul class="nav pull-right">
              <li class="dropdown">
                <a href="#" class="dropdown-toggle" data-toggle="dropdown">External Links <b class="caret"></b></a>
                <ul class="dropdown-menu">
                      <li>      <a href="https://apache.org/"  title="Apache Software Foundation">Apache Software Foundation</a>
</li>
      <li>      <a href="https://incubator.apache.org/"  title="Apache Incubator">Apache Incubator</a>
</li>
                  </ul>
              </li>
            </ul>
          
                      </div>
          
        </div>
      </div>
    </div>
    
        <div class="container">
          <div id="banner">
        <div class="pull-left">
                                                  <a href="../.././" id="bannerLeft">
                <h2>Apache Taverna</h2>
                </a>
                      </div>
        <div class="pull-right">  </div>
        <div class="clear"><hr/></div>
      </div>

      <div id="breadcrumbs">
        <ul class="breadcrumb">
                
                    
                  <li id="publishDate">Last Published: 2015-08-14
                   </li>
                      
                
                    
      
                            </ul>
      </div>

      
                
        <div id="bodyColumn" >
                                  
            
<p>This page contains information:</p>

<ul>
  
<li>for <a href="#api_developers">developers who want to use the API Consumer Tool</a> to wrap their Java  API for the subsequent use in Taverna workflows, and</li>
  
<li>for <a href="#api_users">users who want to use the wrapped Java API</a> inside their workflows.</li>
</ul>
<p><a name="api_developers"></a></p>
<div class="section">
<h2><a name="API_Consumer_Tool"></a>API Consumer Tool</h2>
<p>Current version of the tool is 1.1. You can get it from the old  <a class="externalLink" href="http://www.taverna.org.uk/download/associated-tools/api-consumer-tool">download pages</a>. Please also refer to the  <a class="externalLink" href="http://www.mygrid.org.uk/dev/wiki/display/taverna/API+Consumer+Tool">API Consumer Tool section on the User Manual</a>.</p>
<p>The API Consumer Tool allows the selection of subsets of Java APIs which may then be imported  into Taverna Workbench and used as services in workflows. This tool is intended for API developers rather than end-users. It produces an XML API definition file which Taverna imports - this is file that you distribute  alongside your API to &#x2018;Taverna enable&#x2019; it.</p>
<div class="section">
<h3><a name="Prerequisites"></a>Prerequisites</h3>
<p>The API Consumer Tool is a Java Doclet and uses Ant to launch; you must therefore have Java and  Ant installed and available on the path. The Tool has been tested on Java 1.6; use other versions at your own risk.</p></div>
<div class="section">
<h3><a name="Setup"></a>Setup</h3>
<p>Before running the API Consumer Tool you need to place source files of your API within the  &#x2018;target&#x2019; directory and any supporting libraries (i.e. dependencies) required in the  &#x2018;lib&#x2019; directory. This is particularly important - if your API includes methods which consume or return a type  that is not available to the API Consumer Tool, the definitions it generates will be invalid. For example, if your API contains a method &#x201c;void foo(MagicClass bar)&#x201d; and the MagicClass is in  some random package in a third party jar file that you have not included there is no way for  the Doclet to know the fully qualified classname of MagicClass. As Taverna requires full classnames, this will result in an API that cannot be invoked from  workflows. You can normally trap these issues by watching for the standard JavaDoc warning messages in the  console.</p></div>
<div class="section">
<h3><a name="Usage"></a>Usage</h3>
<p>Once your source and any supporting files are present as described above,  from the API Consumer Tool directory you can either run the  &#x201c;runme.bat&#x201d;/&#x201d;runme.sh script or call Ant directly (just type &#x2018;ant&#x2019; on  the command line). The API Consumer Tool itself will be built from source and applied to the target source files  of your API. After some slight delay for this process (longer for very complex APIs) you should see a screen  such as the following:</p>
<p><img src="/img/APIConsumer-InitialWindow.png" alt="API Consumer" /></p>
<p>The tree on the left hand side of the window shows the available classes (including inner  classes where present) along with a search box - the right hand side currently shows nothing. Selecting a class from the tree produces a display like the following, this should be clearly  similar to the information produced by the standard JavaDoc tool:</p>
<p><img src="/img/APIConsumer-SummaryDisplay.png" alt="API Consumer" /></p>
<p>In the case of large APIs the search box can be used to display a subset of the complete class  tree - enter a pattern to match and hit return in this text box and the tree will be  expanded to show all matching nodes. To return to the view with all nodes expanded clear the text in this box and hit return.</p></div>
<div class="section">
<h3><a name="Adding_methods_to_the_API_definition"></a>Adding methods to the API definition</h3>
<p>The next step is to select methods to add to the API definition - these methods  (static, instance or constructors) will appear as services within Taverna Workbench&#x2019;s  <a href="/documentation/glossary#service_panel">Service Panel</a> when the definition file is imported.</p>
<div class="section">
<h4><a name="Using_graphical_interface"></a>Using graphical interface</h4>
<p>Methods can be manually added by choosing the class, opening the &#x201c;Methods&#x201d; tab and either  selecting individual methods or using the &#x201c;Select all&#x201d; and &#x201c;Clear all&#x201d; boxes:</p>
<p><img src="/img/APIConsumer-Methods.png" alt="API Consumer - methods" /></p></div>
<div class="section">
<h4><a name="Using_JavaDoc_tags"></a>Using JavaDoc tags</h4>
<p>For APIs under your direct control there is an alternative based on JavaDoc tags. By adding the tag &#x201c;@taverna.consume&#x201d; to either classes or individual methods you can  automatically have these methods selected in the API consumer when it first scans the source  files. In the case of the tag at a class or interface level all constructors and methods will be  selected.</p></div></div>
<div class="section">
<h3><a name="API_level_metadata"></a>API level metadata</h3>
<p>To aid use of your exported API you can select the &#x201c;API Description&#x201d; tab and use it to provide  a name and description for the entire API subset:</p>
<p><img src="/img/APIConsumer-Description.png" alt="API Consumer - description" /></p></div>
<div class="section">
<h3><a name="Saving_the_API_definition_file"></a>Saving the API definition file</h3>
<p>To save the API definition select the &amp;&#x201c;File&#x201d; -&gt; &#x201c;Save as XML&#x201d;. This should bring up a standard save dialogue, choose a filename and save. This is the file that is then imported into Taverna Workbench&#x2019;s Service Panel by selecting  &#x201c;Import new services&#x201d; -&gt; &#x201c;API Consumer services&#x2026;&#x201d;.</p>
<p><a name="api_users"></a></p></div></div>
<div class="section">
<h2><a name="Using_API_Consumer_Services_in_Workflows"></a>Using API Consumer Services in Workflows</h2>
<p>Please also refer to  <a class="externalLink" href="http://www.mygrid.org.uk/dev/wiki/display/taverna/API+Consumer">the API Consumer section of the User Manual</a>.</p>
<p>In order to use the API Consumer services in Taverna workflows, you need the XML API Consumer  definition (of the Java library) XML file generated from the API Consumer tool,  the library to be used (compiled and packaged as a <tt>jar</tt>file) and any  dependencies of the library as well (i.e. their <tt>jar</tt> files).</p>
<p>To import the API Consumer definition file into Taverna, click on  **&#x201c;Import new services&#x201d; -&gt; &#x201c;API Consumer services&#x2026;&#x201d; ** in the Service Panel. Select the API Consumer XML definition file. A new branch should be added to the Service Panel, showing the class names and methods that  have been selected for inclusion using the API Consumer Tool. <img src="/img/APIConsumer-ServicePanel.png" alt="API Consumer - service panel" /></p>
<p>In this lightweight example, our exposed API only has a constructor and a single method. Using the API Consumer you have to build up the calls to the API as part of your workflow,  so as <tt>sayHello()</tt> is a method on the <tt>HelloWorld</tt> instance,  we first have to call the constructor <tt>HelloWorld</tt>,  and then call the method on the returned object. We will add both API Consumer services to the workflow. Each parameter of the method is exposed as an input port, and the return value is shown as an  output port. In our example, our methods do not take any parameters except the implicit object reference  <tt>this</tt>, which we will have to provide by connecting the <tt>object</tt>  output of the constructor <tt>HelloWorld</tt> to the <tt>object</tt> input of the  method <tt>sayHello</tt>.</p>
<p><img src="/img/APIConsumer-workflow.png" alt="API Consumer - workflow" /></p>
<p>As a convenience, methods also return the very same object in the output port  <tt>object</tt>, so that methods that needs to be run in a particular sequence can be  chained to pass their object reference, in effect preventing execution of the second method  before the first method is returning its result and object reference.</p>

<blockquote>
<p>Note that the Java objects can only be passed to other API Consumer services (and only if they are <b>serializable</b>); if you want any useful inputs and outputs to interact with your workflow you need to use basic types such as <tt>String</tt>. In our example, <tt>sayHello()</tt> returns a <tt>String</tt> that is connected to the workflow output called <tt>sayHello_Result</tt></p>
</blockquote>
<p>Static methods do not need the <tt>object</tt> reference, and hence do not need the  constructor call, unless you need to pass an instantiated object as a normal argument.</p>
<p>Before you can run the workflow you also need to copy the <tt>jar</tt> file of the  <tt>HelloWorld</tt> library and its dependencies in the <tt>lib</tt> directory of  your <a class="externalLink" href="http://dev.mygrid.org.uk/wiki/display/taverna/Taverna+home+directory">TAVERNA_HOME directory</a>. After copying the jar files, you need to specify which dependencies to use for every API  Consumer service in a workflow. To do so, right-click on the service and select <b>&#x201c;Configure API Consumer&#x2026;&#x201d;</b>. The default classloader sharing is &#x201c;Shared for whole workflow&#x201d;, so you only need to tick of  the dependency <tt>jar</tt> files on one of services using the same API Consumer,  for example the constructor.</p>

<blockquote>
<p>If your API is using JNI, or one of its dependencies uses JNI, which is a native library with binding for Java, you need to take some special considerations, as explained in the section on <a class="externalLink" href="http://www.mygrid.org.uk/dev/wiki/display/taverna/Beanshell#Beanshell-JNIbasednativelibraries" target="_blank">JNI-based native libraries</a> under Beanshell services in the User Manual. In particular, you need to select the System classloader sharing for all your services and modify the Taverna startup scripts.</p>
</blockquote>
<div class="section">
<h3><a name="A_word_of_advice"></a>A word of advice</h3>
<p>Depending on the complexity of your API, building workflows in this way can turn out to be  very a cumbersome way to do graphical Java programming in a workflow. In many cases, writing a <a href="/documentation/glossary#beanshell">Beanshell</a> script using the same  dependency mechanism can give you most of the benefits in a smaller amount of time. However, the API Consumer gives you one major advantage - the workflow designer do not need to  know much about Java and they will see a browsable structure of your API in the  Service Panel, just like the bundled services. The workflow designer does need to know how  to use your API though, but if you have explicitly designed it to be easy to use from  Taverna that barrier can be lowered significantly.</p>
<p>An API that is useful for many people could also be wrapped as a  <a href="/documentation/glossary#wsdl">WSDL Web service</a>, which would make it usable from any  Taverna Workbench without requiring installation of your JAR and API Consumer XML definition  files.</p></div></div>
                  </div>
          </div>

    <hr/>

    <footer>
            <div class="container">
                      <div class="row">
                                      <p >Copyright &copy;                    2015
                        <a href="http://www.apache.org/">The Apache Software Foundation</a>.
            All rights reserved.      
                    
      </p>
                </div>

                <p id="poweredBy" class="pull-right">
                                                                                                                <a href="http://maven.apache.org/" title="Maven" class="builtBy">
        <img class="builtBy"  alt="Maven" src="http://maven.apache.org/images/logos/maven-feather.png"    />
      </a>
                  </p>
        
                </div>
    </footer>
        </body>
</html>
